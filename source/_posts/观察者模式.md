---
title: 观察者模式
categories:
  - 设计模式
tags:
  - 设计模式
abbrlink: 9a246216
---

<!-- more -->

# Observer(观察者)模式

参考：

《JavaScript 设计模式》 P42

[人人都会设计模式：观察者模式--Observer](https://segmentfault.com/a/1190000012295887)

[原生 JavaScript 实现观察者模式](https://blog.csdn.net/lm278858445/article/details/78287492)

[JS 观察者模式](https://segmentfault.com/a/1190000012547812)

[观察者模式](https://segmentfault.com/a/1190000018260980)

## 什么观察者模式

第一次听到这个概念是在我刚学习 vue 的时候，现在已经过去快一年，vue 已经基本熟悉了，现在回过头来学习一下这个传说中的观察者模式。

**首先看一下概念：**

![观察者模式](观察者模式/观察者模式.png)

一个对象（称为 subject）维持一系列依赖于它的对象（观察者），将有关状态的任何变更自动通知给它们。

当一个目标需要告诉观察者发生什么有趣的事情，它会向观察者广播一个通知（可以包括与通知主题相关的特定数据）

当我们不再希望某个特定的观察者获得其注册目标发出的改变通知时，改目标可以将它从观察者列表中删除。

怎么理解呢？
我这里做一个比喻：

将称为 subject 的被观察者对象视为老师；将一系列观察者视为学生。

当老师讲课时，学生聚精会神的听课——现在就是老师（被观察者）向学生（观察者）发出一个通知；

老师讲课时，某一个学生迟到，然后中途加入了听讲的学生行列——这时就是新增加一个观察者；

老师讲课时，某一个学生肚子疼，中途去了厕所——这时就可以认为删除了一个观察者。

好了通俗易懂的理解就到这里，现在看看书上的概念：

_Subject(目标，被观察者)：_

维护一系列观察者，方便添加或删除观察者。

_Observer(观察者)：_

为那些在目标（被观察者）发生改变时需获得通知的对象提供一个更新的接口。

_ConcreateSubject(具体目标)：_

状态发生改变时，向 _Observer_ 发出通知，储存 _ConcreateSubject_ 的状态。

_ConcreteObserver(具体观察者)：_

储存一个指向 _ConcreateSubject_ 的引用，实现 _Observer_ 的更新接口，以使自身状态与目标的状态保持一致。

那么再说一说常见的观察者模式的例子：

在前端业务中，浏览器的事件也是观察者模式

```javascript
div.onclick = function click() {
  alert('这就是一个简单的观察者事件');
};
```

- div 的 click 事件是被观察者
- function click 是观察者
- function click 订阅 div click 事件，事件发生时，对应的动作就是 alert()
